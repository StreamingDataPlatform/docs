(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{108:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return o})),t.d(a,"metadata",(function(){return p})),t.d(a,"toc",(function(){return c})),t.d(a,"default",(function(){return s}));var n=t(3),r=t(7),l=(t(0),t(147)),i=t(152),o={title:"Deploying Spark Applications",sidebar_label:"Deploying"},p={unversionedId:"sdp/analytics/spark/deploying",id:"sdp/analytics/spark/deploying",isDocsHomePage:!1,title:"Deploying Spark Applications",description:"This document describes the process for deploying Spark applications on SDP.",source:"@site/docs/sdp/analytics/spark/deploying.md",slug:"/sdp/analytics/spark/deploying",permalink:"/docs/sdp/analytics/spark/deploying",editUrl:null,version:"current",sidebar_label:"Deploying",sidebar:"mainSidebar",previous:{title:"Apache Spark",permalink:"/docs/sdp/analytics/spark/index"},next:{title:"Troubleshooting Spark",permalink:"/docs/sdp/analytics/spark/troubleshooting"}},c=[{value:"Writing Spark Application for Deployment on SDP",id:"writing-spark-application-for-deployment-on-sdp",children:[]},{value:"Upload Common Artifacts to your Analytics Project",id:"upload-common-artifacts-to-your-analytics-project",children:[]},{value:"Deploying Python Applications using the SDP UI",id:"deploying-python-applications-using-the-sdp-ui",children:[]},{value:"Deploying Python Applications using Kubectl",id:"deploying-python-applications-using-kubectl",children:[]},{value:"Deploying Java or Scala Applications using the SDP UI",id:"deploying-java-or-scala-applications-using-the-sdp-ui",children:[]}],b={toc:c};function s(e){var a=e.components,o=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(n.a)({},b,o,{components:a,mdxType:"MDXLayout"}),Object(l.b)(i.a,{toc:c,mdxType:"TOCInline"}),Object(l.b)("p",null,"This document describes the process for deploying Spark applications on SDP."),Object(l.b)("h2",{id:"writing-spark-application-for-deployment-on-sdp"},"Writing Spark Application for Deployment on SDP"),Object(l.b)("p",null,"To run on SDP, Spark applications must be configured using the options described in the list below. All Spark applications will have the environment variables set appropriately for your environment. However, it is up to your application to retrieve the environment variables and provide them as options to the Spark session."),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",{parentName:"tr",align:null},"Spark Option"),Object(l.b)("th",{parentName:"tr",align:null},"Environment Variable"),Object(l.b)("th",{parentName:"tr",align:null},"Purpose"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"controller"),Object(l.b)("td",{parentName:"tr",align:null},"PRAVEGA_CONTROLLER_URI"),Object(l.b)("td",{parentName:"tr",align:null},"This is the Pravega controller URI for your SDP cluster. For example, ",Object(l.b)("inlineCode",{parentName:"td"},"tcp://nautilus-pravega-controller.nautilus-pravega.svc.cluster.local:9090"),".")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"scope"),Object(l.b)("td",{parentName:"tr",align:null},"PRAVEGA_SCOPE"),Object(l.b)("td",{parentName:"tr",align:null},"This is the Pravega scope, which is equal to the Analytics Project name.")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"allow_create_scope"),Object(l.b)("td",{parentName:"tr",align:null},"N/A"),Object(l.b)("td",{parentName:"tr",align:null},"This must be set to ",Object(l.b)("inlineCode",{parentName:"td"},"false")," since applications in SDP cannot create Pravega scopes.")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"checkpointLocation"),Object(l.b)("td",{parentName:"tr",align:null},"CHECKPOINT_DIR"),Object(l.b)("td",{parentName:"tr",align:null},"Stateful operations in Spark must periodically write checkpoints which can be used to recover from failures. The checkpoint directory identified by this environment variable should be used for this purpose. It will be highly available until the Spark application is deleted. This should be used even for Spark applications which do not use Pravega.")))),Object(l.b)("p",null,"You should use the example applications as a template."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Python: ",Object(l.b)("a",{parentName:"li",href:"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/python/stream_generated_data_to_pravega.py"},"stream_generated_data_to_pravega.py")),Object(l.b)("li",{parentName:"ul"},"Scala: ",Object(l.b)("a",{parentName:"li",href:"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/scala/io/pravega/example/spark/StreamPravegaToConsole.scala"},"StreamPravegaToConsole.scala"))),Object(l.b)("h2",{id:"upload-common-artifacts-to-your-analytics-project"},"Upload Common Artifacts to your Analytics Project"),Object(l.b)("p",null,"This must be completed before running Spark applications with SDP."),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Download the ",Object(l.b)("a",{parentName:"p",href:"https://repo1.maven.org/maven2/io/pravega/pravega-connectors-spark-3.0_2.12/0.9.0/pravega-connectors-spark-3.0_2.12-0.9.0.jar"},"Pravega Connectors for Spark 3.0 JAR")," from Maven Central.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Download the ",Object(l.b)("a",{parentName:"p",href:"https://repo1.maven.org/maven2/io/pravega/pravega-connectors-spark-2.4_2.11/0.9.0/pravega-connectors-spark-2.4_2.11-0.9.0.jar"},"Pravega Connectors for Spark 2.4 JAR")," from Maven Central.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Download the ",Object(l.b)("a",{parentName:"p",href:"https://repo1.maven.org/maven2/io/pravega/pravega-keycloak-client/0.9.0/pravega-keycloak-client-0.9.0.jar"},"Pravega Keycloak Client JAR")," from Maven Central.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Create an Analytics Project if you do not already have one.\nAn Analytics Project can have any number of Flink and Spark applications."))),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",{parentName:"div",className:"admonition-heading"},Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",{parentName:"h5",className:"admonition-icon"},Object(l.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(l.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(l.b)("div",{parentName:"div",className:"admonition-content"},Object(l.b)("p",{parentName:"div"},"In the following steps, be careful to upload the correct file corresponding to the Maven artifact."))),Object(l.b)("ol",{start:5},Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Upload the Pravega Connectors for Spark 3.0 JAR."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Analytics -> Artifacts -> Maven -> Upload Artifact."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Group:")," io.pravega"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Artifact:")," pravega-connectors-spark-3-0-2-12"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Version:")," 0.9.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"File:")," pravega-connectors-spark-3.0_2.12-0.9.0.jar"))),Object(l.b)("li",{parentName:"ol"},"Click Upload."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Upload the Pravega Connectors for Spark 2.4 JAR."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Analytics -> Artifacts -> Maven -> Upload Artifact."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Group:")," io.pravega"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Artifact:")," pravega-connectors-spark-2-4-2-11"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Version:")," 0.9.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"File:")," pravega-connectors-spark-2.4_2.11-0.9.0.jar"))),Object(l.b)("li",{parentName:"ol"},"Click Upload."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Upload the Pravega Keycloak Client JAR."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Analytics -> Artifacts -> Maven -> Upload Artifact."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Group:")," io.pravega"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Artifact:")," pravega-keycloak-client"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Version:")," 0.9.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"File:")," pravega-keycloak-client-0.9.0.jar"))),Object(l.b)("li",{parentName:"ol"},"Click Upload."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"You should now see the following artifacts.\n",Object(l.b)("img",{alt:"maven artifacts",src:t(208).default})))),Object(l.b)("h2",{id:"deploying-python-applications-using-the-sdp-ui"},"Deploying Python Applications using the SDP UI"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Create your Python Spark application file. For example, ",Object(l.b)("a",{parentName:"p",href:"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/python/stream_generated_data_to_pravega.py"},"stream_generated_data_to_pravega.py")," will continuously write a timestamp to a Pravega stream. Save this file as on your local computer.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Upload your Python Spark application."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Analytics -> Artifacts -> Files -> Upload File."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Path:")," ",Object(l.b)("em",{parentName:"li"},"(leave blank)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"File:")," stream_generated_data_to_pravega.py"))),Object(l.b)("li",{parentName:"ol"},"Click Upload."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Create the Spark application."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Spark -> Create New Spark App."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"General",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Type:")," Python"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Name:")," stream-generated-data-to-pravega"))),Object(l.b)("li",{parentName:"ul"},"Source:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"File"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Main Application File:")," stream_generated_data_to_pravega.py"))),Object(l.b)("li",{parentName:"ul"},"Configuration:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Runtime:")," Spark 3.0.1"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Executors:")," 1"))),Object(l.b)("li",{parentName:"ul"},"Additional Jars:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Jars:"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"io.pravega:pravega-connectors-spark-3-0-2-12:0.9.0"),Object(l.b)("li",{parentName:"ul"},"io.pravega:pravega-keycloak-client:0.9.0"))))))),Object(l.b)("li",{parentName:"ol"},"Click Create.")),Object(l.b)("p",{parentName:"li"},Object(l.b)("img",{alt:"application list",src:t(209).default}))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"You may view the application logs by clicking the Logs link."))),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",{parentName:"div",className:"admonition-heading"},Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",{parentName:"h5",className:"admonition-icon"},Object(l.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(l.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(l.b)("div",{parentName:"div",className:"admonition-content"},Object(l.b)("p",{parentName:"div"},"You can also run an application directly from a URL.\nUse the Source type of Custom Path, then enter a URL such as ",Object(l.b)("a",{parentName:"p",href:"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/python/stream_generated_data_to_pravega.py"},Object(l.b)("inlineCode",{parentName:"a"},"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/python/stream_generated_data_to_pravega.py")),"."))),Object(l.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(l.b)("div",{parentName:"div",className:"admonition-heading"},Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",{parentName:"h5",className:"admonition-icon"},Object(l.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(l.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),Object(l.b)("div",{parentName:"div",className:"admonition-content"},Object(l.b)("p",{parentName:"div"},"You should only run an application from a URL if you trust the owner of the URL."))),Object(l.b)("h2",{id:"deploying-python-applications-using-kubectl"},"Deploying Python Applications using Kubectl"),Object(l.b)("p",null,"Much of the deployment process can be scripted with Kubectl."),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Use the SDP UI to create and upload your Python Spark application file. Refer to ",Object(l.b)("a",{parentName:"p",href:"#deploying-python-applications-using-the-sdp-ui"},"Deploying Python Applications using the SDP UI")," for details.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Create a YAML file that defines how the Spark application should be deployed."),Object(l.b)("p",{parentName:"li"},"The following is an example YAML file that can be used to deploy ",Object(l.b)("inlineCode",{parentName:"p"},"stream_generated_data_to_pravega.py"),".\nSave this file as ",Object(l.b)("inlineCode",{parentName:"p"},"stream_generated_data_to_pravega.yaml")," on your local computer."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-yaml",metastring:'title="stream_generated_data_to_pravega.yaml"',title:'"stream_generated_data_to_pravega.yaml"'},'apiVersion: spark.nautilus.dellemc.com/v1beta1\nkind: SparkApplication\nmetadata:\n  name: stream-generated-data-to-pravega\nspec:\n  # Language type of application, Python, Scala, Java  (optional: Defaults to Java if not specified)\n  type: Python\n  # Can be Running, Finished or Stopped (required)\n  state: Running\n  # Main Java/Scala class to execute (required for type:Scala or Java)\n  # mainClass: org.apache.spark.examples.SparkPi\n  # Signifies what the `mainApplicationFile` value represents.\n  # Valid Values: "Maven", "File", "Text".  Default: "Text"\n  mainApplicationFileType: File\n  # Main application file that will be passed to Spark Submit \n  # (interpreted according to `mainApplicationFileType`)\n  mainApplicationFile: "stream_generated_data_to_pravega.py"\n  # Extra Maven dependencies to resolve from Maven Central (optional: Java/Scala ONLY)\n  jars:\n    - "{maven: io.pravega:pravega-connectors-spark-3-0-2-12:0.9.0}"\n    - "{maven: io.pravega:pravega-keycloak-client:0.9.0}"\n  parameters:\n    - name: timeout\n      value: "100000"\n  # Single value arguments passed to application (optional)\n  arguments: []\n  # - "--recreate"\n  # Directory in project storage which will be handed to Application as CHECKPOINT_DIR environment\n  # variable for Application checkpoint files (optional, SDP will use Analytic Project storage)\n  # checkpointPath: /spark-pi-checkpoint-d5722b45-8773-41db-93a4-bab2324d74d0\n  # Number of seconds SDP will wait after signalling shutdown to an application before forcabily\n  # killing the Driver POD (optional, default: 180 seconds)\n  gracefulShutdownTimeout: 180\n  # When to redeploy the application\n  # (optional, default: OnFailure, failureRetries: 3, failureRetryInterval: 10, submissionRetries: 0)\n  retryPolicy:\n    # Valid values: Never, Always, OnFailure\n    type: OnFailure\n    # Number of retries before Application is marked as failed\n    failureRetries: 5\n    # Number of seconds between each retry during application failures\n    failureRetryInterval: 60\n  # Defines shape of cluster to execute application\n  # Reference to a RuntimeImage containing the Spark Runtime to use for the cluster\n  runtime: spark-3.0.1\n  # Driver Resource settings\n  driver:\n    cores: 1\n    memory: 512M\n    # Kubernetes resources that should be applied to the driver POD (optional)\n    resources:\n        requests:\n          cpu: 1\n          memory: 1024Mi\n        limits:\n          cpu: 1\n          memory: 1024Mi\n  # Executor Resource Settings\n  executor:\n    replicas: 1\n    cores: 1\n    memory: 512M\n    # Kubernetes resources that should be applied to each executor POD\n    resources:\n        requests:\n          cpu: 1\n          memory: 1024Mi\n        limits:\n          cpu: 1\n          memory: 1024Mi\n  # Extra key value/pairs to apply to configuration (optional)\n  configuration:\n    spark.reducer.maxSizeInFlight: 48m\n    spark.driver.extraJavaOptions: "-Divy.cache.dir=/tmp -Divy.home=/tmp"\n  # Custom Log4J Logging Levels (optional)\n  logging:\n    org.myapp: DEBUG\n    io.pravega: DEBUG\n    io.pravega.connectors: DEBUG\n  ```\n\n'))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Apply the YAML file with ",Object(l.b)("inlineCode",{parentName:"p"},"kubectl"),"."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-shell"},"NAMESPACE=sparktest1\nkubectl apply -n $NAMESPACE -f stream_generated_data_to_pravega.yaml\n"))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Monitor the Spark application."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-shell"},"kubectl get -n $NAMESPACE SparkApplication/stream-generated-data-to-pravega\n")))),Object(l.b)("h2",{id:"deploying-java-or-scala-applications-using-the-sdp-ui"},"Deploying Java or Scala Applications using the SDP UI"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Prepare your Java/Scala build environment.")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"You must compile your Java or Scala source code to produce a JAR file."),Object(l.b)("p",{parentName:"li"},"The example Scala application ",Object(l.b)("a",{parentName:"p",href:"https://github.com/pravega/pravega-samples/blob/spark-connector-examples/spark-connector-examples/src/main/scala/io/pravega/example/spark/StreamPravegaToConsole.scala"},"StreamPravegaToConsole.scala")," will read strings from a Pravega stream and log them."),Object(l.b)("p",{parentName:"li"},"This will build the file ",Object(l.b)("inlineCode",{parentName:"p"},"pravega-samples/spark-connector-examples/build/libs/pravega-spark-connector-examples-0.9.0.jar"),"."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/pravega/pravega-samples\ncd pravega-samples/spark-connector-examples\n../gradlew build\n"))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Upload your Spark application JAR."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Analytics -> Artifacts -> Maven -> Upload Artifact."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Group:")," io.pravega"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Artifact:")," pravega-spark-connector-examples"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Version:")," 0.9.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"File:")," pravega-spark-connector-examples-0.9.0.jar"))),Object(l.b)("li",{parentName:"ol"},"Click Upload."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"Create the Spark application."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},"Click Spark -> Create New Spark App."),Object(l.b)("li",{parentName:"ol"},"Enter the following:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"General",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Type:")," Scala"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Name:")," pravega-to-console-scala"))),Object(l.b)("li",{parentName:"ul"},"Source:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"Maven"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Artifact:")," io.pravega:pravega-spark-connector-examples:0.9.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Main Class:")," io.pravega.example.spark.StreamPravegaToConsole"))),Object(l.b)("li",{parentName:"ul"},"Configuration:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Runtime:")," Spark 3.0.1"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Executors:")," 1"))),Object(l.b)("li",{parentName:"ul"},"Additional Jars:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Maven Jars:"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"io.pravega:pravega-connectors-spark-3-0-2-12:0.9.0"),Object(l.b)("li",{parentName:"ul"},"io.pravega:pravega-keycloak-client:0.9.0"))))))),Object(l.b)("li",{parentName:"ol"},"Click Create."))),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},"You may view the application logs by clicking the Logs link."),Object(l.b)("p",{parentName:"li"},"When running the above example, you will see output similar the following every 3 seconds."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre"},"-------------------------------------------\nBatch: 29\n-------------------------------------------\n+---------------------+--------+-----------------+----------+------+\n|event                |scope   |stream           |segment_id|offset|\n+---------------------+--------+-----------------+----------+------+\n|2021-03-12 23:37:44.1|examples|streamprocessing1|0         |62582 |\n|2021-03-12 23:37:46.1|examples|streamprocessing1|0         |62611 |\n|2021-03-12 23:37:45.1|examples|streamprocessing1|0         |62640 |\n+---------------------+--------+-----------------+----------+------+\n")))))}s.isMDXComponent=!0},147:function(e,a,t){"use strict";t.d(a,"a",(function(){return s})),t.d(a,"b",(function(){return d}));var n=t(0),r=t.n(n);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function p(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=r.a.createContext({}),b=function(e){var a=r.a.useContext(c),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},s=function(e){var a=b(e.components);return r.a.createElement(c.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return r.a.createElement(r.a.Fragment,{},a)}},u=r.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),s=b(t),u=n,d=s["".concat(i,".").concat(u)]||s[u]||m[u]||l;return t?r.a.createElement(d,o(o({ref:a},c),{},{components:t})):r.a.createElement(d,o({ref:a},c))}));function d(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var l=t.length,i=new Array(l);i[0]=u;var o={};for(var p in a)hasOwnProperty.call(a,p)&&(o[p]=a[p]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var c=2;c<l;c++)i[c]=t[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},148:function(e,a,t){"use strict";function n(e){var a,t,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(a=0;a<e.length;a++)e[a]&&(t=n(e[a]))&&(r&&(r+=" "),r+=t);else for(a in e)e[a]&&(r&&(r+=" "),r+=a);return r}a.a=function(){for(var e,a,t=0,r="";t<arguments.length;)(e=arguments[t++])&&(a=n(e))&&(r&&(r+=" "),r+=a);return r}},152:function(e,a,t){"use strict";var n=t(0),r=t.n(n),l=t(148),i=t(56),o=t.n(i);function p({toc:e,isChild:a}){return e.length?r.a.createElement("ul",{className:a?"":"table-of-contents"},e.map((e=>r.a.createElement("li",{key:e.id},r.a.createElement("a",{href:`#${e.id}`,dangerouslySetInnerHTML:{__html:e.value}}),r.a.createElement(p,{isChild:!0,toc:e.children}))))):null}a.a=function({toc:e}){return r.a.createElement("div",{className:Object(l.a)(o.a.tableOfContentsInline)},r.a.createElement(p,{toc:e}))}},208:function(e,a,t){"use strict";t.r(a),a.default=t.p+"assets/images/artifacts-maven-83b560802e4114a6e373dfd8cdc4e35d.png"},209:function(e,a,t){"use strict";t.r(a),a.default=t.p+"assets/images/application-list-efeaaece63c615e8fddf833228261d45.png"}}]);