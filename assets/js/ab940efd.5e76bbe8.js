(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{129:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return s}));var a=n(3),r=n(7),i=(n(0),n(160)),c={title:"Setting Up Security for a Distributed Mode Cluster"},l={unversionedId:"pravega/security/securing-distributed-mode-cluster",id:"pravega/security/securing-distributed-mode-cluster",isDocsHomePage:!1,title:"Setting Up Security for a Distributed Mode Cluster",description:"\x3c!--",source:"@site/docs/pravega/security/securing-distributed-mode-cluster.md",slug:"/pravega/security/securing-distributed-mode-cluster",permalink:"/docs/docs/pravega/security/securing-distributed-mode-cluster",editUrl:"https://github.com/claudiofahey/pravega/edit/docusaurus/documentation/src/docs/security/securing-distributed-mode-cluster.md",version:"current",sidebar:"mainSidebar",previous:{title:"Pravega Encryption",permalink:"/docs/docs/pravega/security/pravega-security-encryption"},next:{title:"Contributing to Pravega",permalink:"/docs/docs/pravega/contributing"}},o=[{value:"Introduction",id:"introduction",children:[]},{value:"Generating Certificates and Other TLS Artifacts",id:"generating-certificates-and-other-tls-artifacts",children:[]},{value:"Enabling TLS and Auth in Pravega",id:"enabling-tls-and-auth-in-pravega",children:[{value:"Configuring TLS and Auth on Server Side",id:"configuring-tls-and-auth-on-server-side",children:[]},{value:"Configuring TLS and Credentials on Client Side",id:"configuring-tls-and-credentials-on-client-side",children:[]},{value:"Having TLS and Auth Take Effect",id:"having-tls-and-auth-take-effect",children:[]}]},{value:"Conclusion",id:"conclusion",children:[]}],b={toc:o};function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#introduction"},"Introduction")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#generating-certificates-and-other-tls-artifacts"},"Generating Certificates and Other TLS Artifacts")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#enabling-tls-and-auth-in-pravega"},"Enabling TLS and Auth in Pravega"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#configuring-tls-and-auth-on-server-side"},"Configuring TLS and Auth on Server Side")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#configuring-tls-and-credentials-on-client-side"},"Configuring TLS and Credentials on Client Side"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#server-hostname-verification"},"Server Hostname Verification")))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#having-tls-and-auth-take-effect"},"Having TLS and Auth Take Effect")))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"#conclusion"},"Conclusion"))),Object(i.b)("h2",{id:"introduction"},"Introduction"),Object(i.b)("p",null,"In the ",Object(i.b)("a",{parentName:"p",href:"/docs/docs/pravega/deployment/deployment#pravega-modes"},"distributed mode")," of running a Pravega cluster, each service runs\nseparately on one or more processes, usually spread across multiple machines. The deployment options of this mode\ninclude:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"A manual deployment in hardware or virtual machines"),Object(i.b)("li",{parentName:"ol"},"Containerized deployments of these types:",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"A Kubernetes native application deployed using the Pravega Operator"),Object(i.b)("li",{parentName:"ul"},"A Docker Compose application deployment"),Object(i.b)("li",{parentName:"ul"},"A Docker Swarm based distributed deployment")))),Object(i.b)("p",null,"Regardless of the deployment option used, setting up Transport Layer Security (TLS) and Pravega Auth (short for\nauthentication and authorization) are essential requirements of a secure Pravega deployment. TLS encrypts\nclient-server as well as internal communication server components. TLS also enables clients to authenticate\nthe services running on the server. Auth, on the other hand, enables the services to validate that the users accounts\nused for accessing them have requisite access permissions. Pravega strongly recommends enabling both TLS and Auth in\nproduction."),Object(i.b)("p",null,"This document lists steps for enabling TLS and auth for manual deployments. Depending on the deployment option\nused and your environment, you might need to modify the steps and commands to suit your specific needs and policies."),Object(i.b)("h2",{id:"generating-certificates-and-other-tls-artifacts"},"Generating Certificates and Other TLS Artifacts"),Object(i.b)("p",null,"At a high-level, setting up TLS in Pravega comprises of two distinct activities:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Generating TLS Certificates, private Keys, keystore, truststore and other artifacts, which involves\nsteps that Pravega is oblivious to."),Object(i.b)("li",{parentName:"ol"},"Enabling and configuring TLS in Pravega.")),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"/docs/docs/pravega/security/generating-tls-artifacts"},"Creating TLS Certificates, Keys and Other TLS Artifacts")," explains how to perform the\nfirst activity. The ",Object(i.b)("a",{parentName:"p",href:"#enabling-tls-and-auth-in-pravega"},"next")," section explains the second activity. "),Object(i.b)("h2",{id:"enabling-tls-and-auth-in-pravega"},"Enabling TLS and Auth in Pravega"),Object(i.b)("p",null,"The high-level steps for enabling TLS and Auth, are:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Configuring TLS and auth on server side"),Object(i.b)("li",{parentName:"ol"},"Configuring TLS and credentials on client Side"),Object(i.b)("li",{parentName:"ol"},"Having TLS and auth take effect")),Object(i.b)("p",null,"These steps are discussed in the following sub-sections."),Object(i.b)("h3",{id:"configuring-tls-and-auth-on-server-side"},"Configuring TLS and Auth on Server Side"),Object(i.b)("p",null,"You can configure the following services for TLS and Auth:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Controller"),Object(i.b)("li",{parentName:"ol"},"Segment Store"),Object(i.b)("li",{parentName:"ol"},"Zookeeper (optional)"),Object(i.b)("li",{parentName:"ol"},"Bookkeeper (optional)")),Object(i.b)("p",null,"For information about enabling TLS for Zookeeper and Bookeeper, refer to\ntheir documentation here:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://cwiki.apache.org/confluence/display/ZOOKEEPER/ZooKeeper+SSL+User+Guide"},"ZooKeeper SSL Guide")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://bookkeeper.apache.org/docs/latest/security/tls/"},"BookKeeper - Encryption and Authentication using TLS"))),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Controller")),Object(i.b)("p",null,"Controller services can be configured in two different ways:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"By specifying the configuration parameter values directly in the ",Object(i.b)("inlineCode",{parentName:"p"},"controller.config.properties")," file. For example,"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre"},"controller.security.tls.enable=true\ncontroller.security.tls.server.certificate.location=/etc/secrets/server-cert.crt\n"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"By specifying configuration parameters as JVM system properties when starting the Controller service instance. "),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre"},"# Example: docker-compose.yml file\n...\nservices:\n   ...\n   controller:\n      environment:\n          ...\n          JAVA_OPTS:\n             -dcontroller.security.tls.enable=true\n             -dcontroller.security.tls.server.certificate.location=...\n             ...\n   ...          \n")))),Object(i.b)("p",null,"The following table lists the Controller service's TLS and auth parameters as well as samples values, for quick reference.\nFor a detailed description of these parameters, refer to the\n",Object(i.b)("a",{parentName:"p",href:"https://github.com/pravega/pravega/blob/master/documentation/src/docs/security/pravega-security-configurations.md"},"Pravega Security Configurations")," document."),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",{parentName:"tr",align:"center"},"Configuration Parameter"),Object(i.b)("th",{parentName:"tr",align:"left"},"Example Value"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.server.certificate.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server-cert.crt"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.server.privateKey.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server-key.key"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.trustStore.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/ca-cert.crt"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.server.keyStore.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server.keystore.jks"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.tls.server.keyStore.pwd.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server.keystore.jks.password")," ",Object(i.b)("sup",null,"1"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.zk.connect.security.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"false")," ",Object(i.b)("sup",null,"2"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.zk.connect.security.tls.trustStore.location")),Object(i.b)("td",{parentName:"tr",align:"left"},"Unspecified ",Object(i.b)("sup",null,"2"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.zk.connect.security.tls.trustStore.pwd.location")),Object(i.b)("td",{parentName:"tr",align:"left"},"Unspecified ",Object(i.b)("sup",null,"2"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.auth.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.pwdAuthHandler.accountsDb.location")," ",Object(i.b)("sup",null,"3")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/password-auth-handler.database"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"controller.security.auth.delegationToken.signingKey.basis")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"a-secret-value"))))),Object(i.b)("p",null," ","[1]",": This and other ",Object(i.b)("inlineCode",{parentName:"p"},".password")," files are text files containing the password for the corresponding store."),Object(i.b)("p",null," ","[2]",": It is assumed here that Zookeeper TLS is disabled. You may enable it and specify the corresponding client-side\nTLS configuration properties via the ",Object(i.b)("inlineCode",{parentName:"p"},"controller.zk.*")," properties."),Object(i.b)("p",null," ","[3]",": This configuration property is required when using the default Password Auth Handler only."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Segment Store")),Object(i.b)("p",null,"Segment store supports security configuration via a properties file (",Object(i.b)("inlineCode",{parentName:"p"},"config.properties"),") or JVM system properties. The table\nbelow lists its TLS and auth parameters and sample values. For a detailed discription of these parameters refer to\n",Object(i.b)("a",{parentName:"p",href:"https://github.com/pravega/pravega/blob/master/documentation/src/docs/security/pravega-security-configurations.md"},"Pravega Security Configurations")," document."),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",{parentName:"tr",align:"center"},"Configuration Parameter"),Object(i.b)("th",{parentName:"tr",align:"left"},"Example Value"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.security.tls.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.security.tls.server.certificate.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server-cert.crt"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.security.tls.certificate.autoReload.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"false"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.security.tls.server.privateKey.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/server-key.key"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.zk.connect.security.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"false")," ",Object(i.b)("sup",null,"1"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.zk.connect.security.tls.trustStore.location")),Object(i.b)("td",{parentName:"tr",align:"left"},"Unspecified ",Object(i.b)("sup",null,"1"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravegaservice.zk.connect.security.tls.trustStore.pwd.location")),Object(i.b)("td",{parentName:"tr",align:"left"},"Unspecified ",Object(i.b)("sup",null,"1"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"autoScale.controller.connect.security.tls.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"autoScale.controller.connect.security.tls.truststore.location")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"/etc/secrets/ca-cert.crt"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"autoScale.controller.connect.security.auth.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"autoScale.security.auth.token.signingKey.basis")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"a-secret-value")," ",Object(i.b)("sup",null,"2"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"autoScale.controller.connect.security.tls.validateHostName.enable")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"true"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravega.client.auth.loadDynamic")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"false"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravega.client.auth.method")),Object(i.b)("td",{parentName:"tr",align:"left"},Object(i.b)("inlineCode",{parentName:"td"},"Basic"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:"center"},Object(i.b)("inlineCode",{parentName:"td"},"pravega.client.auth.token")),Object(i.b)("td",{parentName:"tr",align:"left"},"Base64-encoded value of 'username:password' string")))),Object(i.b)("p",null,"[1]",": The secret value you use here must match the same value used for other Controller and Segment Store services."),Object(i.b)("p",null,"[2]",": It is assumed here that Zookeeper TLS is disabled. You may enable it and specify the corresponding client-side TLS\nconfiguration properties via these properties."),Object(i.b)("h3",{id:"configuring-tls-and-credentials-on-client-side"},"Configuring TLS and Credentials on Client Side"),Object(i.b)("p",null,"After enabling and configuring TLS and auth on the server-side services, it's time for the clients' setup."),Object(i.b)("p",null,"Clients can be made to trust the server's certificates signed by custom CA's using one of the following ways:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Configure the client application to use the signing CA's certificate as the truststore. Alternatively, use the\nservers' certificate as the truststore. "),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-java"},'ClientConfig clientConfig = ClientConfig.builder()\n           .controllerURI("tls://<dns-name-or-ip>:9090")\n           .trustStore("/etc/secrets/ca-cert.crt")\n           ...\n           .build();\n'))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Install the CA's certificate in the Java system key store. ")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Create a custom truststore with the CA's certificate and supply it to the Pravega client application,\nvia standard JVM system properties ",Object(i.b)("inlineCode",{parentName:"p"},"javax.net.ssl.trustStore")," and ",Object(i.b)("inlineCode",{parentName:"p"},"javax.net.ssl.trustStorePassword"),"."))),Object(i.b)("p",null,"For auth, client-side configuration depends on the ",Object(i.b)("inlineCode",{parentName:"p"},"AuthHandler"),' implementation used. If your server is configured to\nuse the built-in Password Auth Handler that supports "Basic" authentication, you may supply the credentials as shown below.'),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'ClientConfig clientConfig = ClientConfig.builder()\n              .controllerURI("tls://<dns-name-or-ip>:9090")\n              .trustStore("/etc/secrets/ca-cert.crt")\n              .credentials(new DefaultCredentials("<password>", "<username>"))\n              .build();\n')),Object(i.b)("h4",{id:"server-hostname-verification"},"Server Hostname Verification"),Object(i.b)("p",null,"For client's server hostname verification to succeed during TLS handshake, the hostname/IP address it uses for accessing the\nserver must match one of the following in the server's certificate:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Common Name (",Object(i.b)("inlineCode",{parentName:"li"},"CN"),") in the certificate's ",Object(i.b)("inlineCode",{parentName:"li"},"Subject")," field"),Object(i.b)("li",{parentName:"ul"},"One of the ",Object(i.b)("inlineCode",{parentName:"li"},"Subject Alternative Names")," (SAN) field entries")),Object(i.b)("p",null,"Even if the server listens on the loopback address ",Object(i.b)("inlineCode",{parentName:"p"},"127.0.0.1")," and its certificate is assigned to ",Object(i.b)("inlineCode",{parentName:"p"},"localhost"),", hostname\nverification will fail if the client attempts to access the server via ",Object(i.b)("inlineCode",{parentName:"p"},"127.0.0.1"),". For the verification to pass,\nthe client must access the server using the hostname assigned on the certificate ",Object(i.b)("inlineCode",{parentName:"p"},"localhost")," and have a hosts file entry\nthat maps ",Object(i.b)("inlineCode",{parentName:"p"},"localhost")," to ",Object(i.b)("inlineCode",{parentName:"p"},"127.0.0.1")," (which is usually already there). "),Object(i.b)("p",null,"Similarly, if the server certificate is assigned to a non-routable hostname on the network (say, ",Object(i.b)("inlineCode",{parentName:"p"},"controller01.pravega.io"),"),\nyou might need to add an IP address and DNS/host name mapping in the client's operating system hosts file. "),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"10.243.221.34 controller01.pravega.io\n")),Object(i.b)("p",null,"If you are reusing preexisting certificate for development/testing on new hosts, you might need to disable hostname\nverification. To do so, call ",Object(i.b)("inlineCode",{parentName:"p"},"validateHostName(false)")," of the ClientConfig builder, as shown below. Never disable\nhostname verification in production."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'ClientConfig clientConfig = ClientConfig.builder()\n              .controllerURI("tls://<dns-name-or-ip>:9090")\n              .trustStore("/etc/secrets/ca-cert.crt")\n              .validateHostName(false)\n              .credentials(...)\n              .build();\n')),Object(i.b)("h3",{id:"having-tls-and-auth-take-effect"},"Having TLS and Auth Take Effect"),Object(i.b)("p",null,"Any changes to TLS and auth configuration parameters take effect only when the service starts. So, changing those\nconfigurations require a restart of the services. The same is true for clients, as well."),Object(i.b)("h2",{id:"conclusion"},"Conclusion"),Object(i.b)("p",null,"This document explained about how to enable security in a Pravega cluster running in distributed mode.\nSpecifically, how to perform the following actions were discussed:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Generating a CA (if needed)"),Object(i.b)("li",{parentName:"ul"},"Generating server certificates and keys for Pravega services"),Object(i.b)("li",{parentName:"ul"},"Signing the generated certificates using the generated CA"),Object(i.b)("li",{parentName:"ul"},"Enabling and configuring TLS and auth on the server Side"),Object(i.b)("li",{parentName:"ul"},"Setting up the ",Object(i.b)("inlineCode",{parentName:"li"},"ClientConfig")," on the client side for communicating with a Pravega cluster running with TLS and auth enabled"),Object(i.b)("li",{parentName:"ul"},"Having TLS and auth take effect")))}s.isMDXComponent=!0},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,b=o(e,["components","mdxType","originalType","parentName"]),d=s(n),u=a,m=d["".concat(c,".").concat(u)]||d[u]||p[u]||i;return n?r.a.createElement(m,l(l({ref:t},b),{},{components:n})):r.a.createElement(m,l({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,c=new Array(i);c[0]=u;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,c[1]=l;for(var b=2;b<i;b++)c[b]=n[b];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);