<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="Dell EMC Streaming Data Platform Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="Dell EMC Streaming Data Platform Blog Atom Feed"><title data-react-helmet="true">Pravega Metrics | Dell EMC Streaming Data Platform</title><meta data-react-helmet="true" property="og:url" content="https://StreamingDataPlatform.github.io//docs/docs/pravega/metrics"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Pravega Metrics | Dell EMC Streaming Data Platform"><meta data-react-helmet="true" name="description" content="&lt;!--"><meta data-react-helmet="true" property="og:description" content="&lt;!--"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://StreamingDataPlatform.github.io//docs/docs/pravega/metrics"><link data-react-helmet="true" rel="alternate" href="https://StreamingDataPlatform.github.io//docs/docs/pravega/metrics" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://StreamingDataPlatform.github.io//docs/docs/pravega/metrics" hreflang="x-default"><link rel="stylesheet" href="/docs/assets/css/styles.a6478483.css">
<link rel="preload" href="/docs/assets/js/styles.dfd6e6ea.js" as="script">
<link rel="preload" href="/docs/assets/js/runtime~main.5a82f47e.js" as="script">
<link rel="preload" href="/docs/assets/js/main.f228fd44.js" as="script">
<link rel="preload" href="/docs/assets/js/1.a92098fc.js" as="script">
<link rel="preload" href="/docs/assets/js/2.e13a85bb.js" as="script">
<link rel="preload" href="/docs/assets/js/88.bb5da98b.js" as="script">
<link rel="preload" href="/docs/assets/js/89.14a0472b.js" as="script">
<link rel="preload" href="/docs/assets/js/935f2afb.9331ca0d.js" as="script">
<link rel="preload" href="/docs/assets/js/17896441.99919929.js" as="script">
<link rel="preload" href="/docs/assets/js/8c217bf2.1bb5569c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.dell.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/docs/img/logo.svg" alt="Dell Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs/img/logo.svg" alt="Dell Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/docs/sdp/overview">Docs</a><a class="navbar__item navbar__link" href="/docs/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pravega/pravega" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.dell.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/docs/img/logo.svg" alt="Dell Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs/img/logo.svg" alt="Dell Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/docs/sdp/overview">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/pravega/pravega" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Streaming Data Platform</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/about">About</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Installation and Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/install/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/install/guide">Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/troubleshooting/overview">Overview</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Developer&#x27;s Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/developer-guide/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/developer-guide/guide">Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Analytics</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Flink</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/analytics/flink/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Spark</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/analytics/spark/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/analytics/spark/deploying">Deploying</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/analytics/spark/troubleshooting">Troubleshooting</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Security Configuration Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/security-configuration/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/security-configuration/guide">Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SDP on Edge</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/edge/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/edge/solution-architecture">Solution Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/edge/pravega-sensor-collector">Pravega Sensor Collector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/sdp/edge/pravega-flink-tools">Pravega Flink Tools</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Pravega</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/overview">Pravega Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/getting-started">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Understanding Pravega</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/pravega-concepts">Pravega Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/terminology">Terminology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/key-features">Pravega Key Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/faq">Frequently Asked Questions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/segment-store-service">Pravega Segment Store Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/segment-containers">Segment Containers in a Pravega Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/controller-service">Pravega Controller Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/wire-protocol">Pravega Streaming Service Wire Protocol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/state-synchronizer-design">State Synchronizer Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/reader-group-design">Reader Groups Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/watermarking">Watermarking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Developing Pravega Applications</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/pravega-write-read-methods">Methods for Writing and Reading Pravega Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/javadoc">Java API Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/rest/restapis">Pravega Controller APIs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/connectors">Pravega Connectors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/basic-reader-and-writer">Basic Reader and Writer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/state-synchronizer">State Synchronizer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/transactions">Transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/streamcuts">StreamCuts</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Running Pravega</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/deployment">Pravega Deployment Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/manual-install">Manual Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/kubernetes-install">Deploying in Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/docker-swarm">Deploying in a Docker Swarm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/dcos-install">Deploying on DC/OS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/pravega/deployment/aws-install">Running on AWS</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/docs/pravega/metrics">Pravega Metrics</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Pravega Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/auth/auth-plugin">Implementation of Pravega Authentication/Authorization Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/auth/client-auth">Client Auth Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/security/pravega-security-authorization-authentication">TLS, Authorization, Authentication - Enabling encryption, authorization and authentication features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/security/pravega-security-configurations">Pravega Security Configurations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/security/pravega-security-encryption">Pravega Encryption</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/security/securing-distributed-mode-cluster">Setting Up Security for a Distributed Mode Cluster</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Contributing to Pravega</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/contributing">Contributing to Pravega</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/roadmap">Pravega Roadmap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/pravega/join-community">Join the Pravega Community</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Connectors</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Flink</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/quickstart">Quick Start</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/streaming">Streaming</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/batch">Batch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/table-api">Table API</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/configurations">Configurations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/flink-connectors/serialization">Serialization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Spark</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/samples">Samples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/build-connector">Building the Connector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/spark-connectors/limitations">Limitations</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/pravega/nifi-pravega" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">NiFi</a></li><li class="menu__list-item"><a href="https://github.com/pravega?q=logstash" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Logstash</a></li><li class="menu__list-item"><a href="https://github.com/pravega/boomi-connector" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Boomi</a></li><li class="menu__list-item"><a href="https://github.com/pravega/kafka-adapter" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Kafka Adapter</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Pravega Metrics</h1></header><div class="markdown"><ul><li><a href="#metrics-interfaces-and-examples-usage">Metrics Interfaces and Examples Usage</a><ul><li><a href="#metrics-service-provider--interface-statsprovider">Metrics Service Provider â€” Interface StatsProvider</a></li><li><a href="#metric-logger--interface-statslogger">Metric Logger â€” Interface StatsLogger</a></li><li><a href="#metric-sub-logger--opstatslogger">Metric Sub Logger â€” OpStatsLogger</a></li><li><a href="#metric-logger--interface-dynamiclogger">Metric Logger â€” Interface DynamicLogger</a></li></ul></li><li><a href="#example-for-starting-a-metric-service">Example for Starting a Metric Service</a><ul><li><a href="#example-for-dynamic-counter-and-opstatsloggertimer">Example for Dynamic Counter and OpStatsLogger(Timer)</a></li><li><a href="#example-for-dynamic-gauge">Example for Dynamic Gauge</a></li><li><a href="#example-for-dynamic-meter">Example for Dynamic Meter</a></li></ul></li><li><a href="#metric-registries-and-configurations">Metric Registries and Configurations</a></li><li><a href="#creating-own-metrics">Creating Own Metrics</a></li><li><a href="#metrics-naming-conventions">Metrics Naming Conventions</a></li><li><a href="#available-metrics-and-their-names">Available Metrics and Their Names</a><ul><li><a href="#metrics-in-jvm">Metrics in JVM</a></li><li><a href="#metrics-in-segment-store-service">Metrics in Segment Store Service</a></li><li><a href="#metrics-in-controller-service">Metrics in Controller Service</a></li></ul></li><li><a href="#resources">Resources</a></li></ul><p>In the Pravega Metrics Framework, we use <a href="https://micrometer.io/docs" target="_blank" rel="noopener noreferrer">Micrometer Metrics</a> as the underlying library, and provide our own API to make it easier to use.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-interfaces-and-examples-usage"></a>Metrics Interfaces and Examples Usage<a class="hash-link" href="#metrics-interfaces-and-examples-usage" title="Direct link to heading">#</a></h1><ul><li><p><code>StatsProvider</code>: The Statistics Provider which provides the whole Metric service.</p></li><li><p><code>StatsLogger</code>: The Statistics Logger is where the required Metrics (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>/<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>/<a href="https://micrometer.io/docs/concepts#_timers" target="_blank" rel="noopener noreferrer">Timer</a>/<a href="https://micrometer.io/docs/concepts#_distribution_summaries" target="_blank" rel="noopener noreferrer">Distribution Summary</a>) are registered.</p></li><li><p><code>OpStatsLogger</code>: The Operation Statistics Logger is a sub-metric for the complex ones (<a href="https://micrometer.io/docs/concepts#_timers" target="_blank" rel="noopener noreferrer">Timer</a>/<a href="https://micrometer.io/docs/concepts#_distribution_summaries" target="_blank" rel="noopener noreferrer">Distribution Summary</a>). It is included in <code>StatsLogger</code> and <code>DynamicLogger</code>.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-service-provider--interface-statsprovider"></a>Metrics Service Provider â€” Interface StatsProvider<a class="hash-link" href="#metrics-service-provider--interface-statsprovider" title="Direct link to heading">#</a></h2><p>Pravega Metric Framework is initiated using the <code>StatsProvider</code> interface: it provides the <em>start</em> and <em>stop</em> methods for the Metric service. It also provides <code>startWithoutExporting()</code> for testing purpose, which only stores metrics in memory without exporting them to external systems. Currently we have support for <a href="https://github.com/b/statsd_spec" target="_blank" rel="noopener noreferrer">StatsD</a> and <a href="https://www.influxdata.com/" target="_blank" rel="noopener noreferrer">InfluxDB</a> registries.</p><p><a href="https://github.com/pravega/pravega/blob/master/shared/metrics/src/main/java/io/pravega/shared/metrics/StatsProvider.java" target="_blank" rel="noopener noreferrer">StatsProvider</a></p><ul><li><code>start()</code>: Initializes the <a href="https://micrometer.io/docs/concepts#_registry" target="_blank" rel="noopener noreferrer">MetricRegistry</a> and Reporters for our Metric service.</li><li><code>startWithoutExporting()</code>: Initializes <code>SimpleMeterRegistry</code> that holds the latest value of each Meter in memory and does not export the data anywhere, typically for unit tests.</li><li><code>close()</code>: Shuts down the Metric Service.</li><li><code>createStatsLogger()</code>: Create a <code>StatsLogger</code> instance which is used to register and return metric objects. Application code could then perform metric operations directly with the returned metric objects.</li><li><code>createDynamicLogger()</code>: Creates a Dynamic Logger.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metric-logger--interface-statslogger"></a>Metric Logger â€” Interface StatsLogger<a class="hash-link" href="#metric-logger--interface-statslogger" title="Direct link to heading">#</a></h2><p>This interface can be used to register the required metrics for simple types like <a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a> and <a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a> and some complex statistics type of Metric like <code>OpStatsLogger</code>, through which we provide <a href="https://micrometer.io/docs/concepts#_timers" target="_blank" rel="noopener noreferrer">Timer</a> and
<a href="https://micrometer.io/docs/concepts#_distribution_summaries" target="_blank" rel="noopener noreferrer">Distribution Summary</a>.</p><p><a href="https://github.com/pravega/pravega/blob/master/shared/metrics/src/main/java/io/pravega/shared/metrics/StatsLogger.java" target="_blank" rel="noopener noreferrer">StatsLogger</a></p><ul><li><code>createStats()</code>: Register and get a <code>OpStatsLogger</code>, which is used for complex type of metrics. Notice the optional metric tags.</li><li><code>createCounter()</code>: Register and get a <a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a> Metric.</li><li><code>createMeter()</code>: Create and register a <a href="https://micrometer.io/docs/concepts#_meters" target="_blank" rel="noopener noreferrer">Meter</a> Metric.</li><li><code>registerGauge()</code>: Register a <a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a> Metric.</li><li><code>createScopeLogger()</code>: Create the <code>StatsLogger</code> under the given scope name.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metric-sub-logger--opstatslogger"></a>Metric Sub Logger â€” OpStatsLogger<a class="hash-link" href="#metric-sub-logger--opstatslogger" title="Direct link to heading">#</a></h2><p><code>OpStatsLogger</code> can be used if the user is interested in measuring the latency of operations like <code>CreateSegment</code> and <code>ReadSegment</code>. Further, we could use it to record the <em>number of operation</em> and <em>time/duration</em> of each operation.</p><p><a href="https://github.com/pravega/pravega/blob/master/shared/metrics/src/main/java/io/pravega/shared/metrics/OpStatsLogger.java" target="_blank" rel="noopener noreferrer">OpStatsLogger</a></p><ul><li><code>reportSuccessEvent()</code>: Used to track the <a href="https://micrometer.io/docs/concepts#_timers" target="_blank" rel="noopener noreferrer">Timer</a> of a successful operation and will record the latency in nanoseconds in the required metric.</li><li><code>reportFailEvent()</code>: Used to track the <a href="https://micrometer.io/docs/concepts#_timers" target="_blank" rel="noopener noreferrer">Timer</a> of a failed operation and will record the latency in nanoseconds in required metric.  </li><li><code>reportSuccessValue()</code>: Used to track the <a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a> of a success value.</li><li><code>reportFailValue()</code>: Used to track the <a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a> of a failed value.</li><li><code>toOpStatsData()</code>:  Used to support the <a href="https://metrics.dropwizard.io/3.1.0/manual/core/#jmx" target="_blank" rel="noopener noreferrer">JMX</a> Reporters and unit tests.</li><li><code>clear</code>: Used to clear the stats for this operation.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metric-logger--interface-dynamiclogger"></a>Metric Logger â€” Interface DynamicLogger<a class="hash-link" href="#metric-logger--interface-dynamiclogger" title="Direct link to heading">#</a></h2><p>The following is an example of a simple interface that exposes only the simple type metrics: (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>/<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>/<a href="https://micrometer.io/docs/concepts#_meters" target="_blank" rel="noopener noreferrer">Meter</a>).</p><p><a href="https://github.com/pravega/pravega/blob/master/shared/metrics/src/main/java/io/pravega/shared/metrics/DynamicLogger.java" target="_blank" rel="noopener noreferrer">DynamicLogger</a></p><ul><li><code>incCounterValue()</code>: Increases the <a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a> with the given value. Notice the optional metric tags.</li><li><code>updateCounterValue()</code>: Updates the <a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a> with the given value.</li><li><code>freezeCounter()</code>: Notifies that, the <a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a> will not be updated.</li><li><code>reportGaugeValue()</code>: Reports the <a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a> value.</li><li><code>freezeGaugeValue()</code>: Notifies that, the <a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a> value will not be updated.</li><li><code>recordMeterEvents()</code>: Records the occurrences of a given number of events in <a href="https://micrometer.io/docs/concepts#_meters" target="_blank" rel="noopener noreferrer">Meter</a>.</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-for-starting-a-metric-service"></a>Example for Starting a Metric Service<a class="hash-link" href="#example-for-starting-a-metric-service" title="Direct link to heading">#</a></h1><p>This example is from <code>io.pravega.segmentstore.server.host.ServiceStarter</code>. The code for this example can be found <a href="https://github.com/pravega/pravega/blob/master/segmentstore/server/host/src/main/java/io/pravega/segmentstore/server/host/ServiceStarter.java" target="_blank" rel="noopener noreferrer">here</a>. It starts Pravega Segment Store service and the Metrics Service is started as a sub service.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-for-dynamic-counter-and-opstatsloggertimer"></a>Example for Dynamic Counter and OpStatsLogger(Timer)<a class="hash-link" href="#example-for-dynamic-counter-and-opstatsloggertimer" title="Direct link to heading">#</a></h2><p>This is an example from <code>io.pravega.segmentstore.server.host.stat.SegmentStatsRecorderImpl.java</code>. The code for this example can be found <a href="https://github.com/pravega/pravega/blob/master/segmentstore/server/host/src/main/java/io/pravega/segmentstore/server/host/stat/SegmentStatsRecorderImpl.java" target="_blank" rel="noopener noreferrer">here</a>. In the class <code>PravegaRequestProcessor</code>, we have registered two metrics:</p><ul><li>one Timer (<code>createStreamSegment</code>)</li><li>one dynamic counter (<code>dynamicLogger</code>)</li></ul><p>From the above example, we can see the required steps to register and use dynamic counter:</p><ol><li>Get a dynamic logger from MetricsProvider:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DynamicLogger dynamicLogger = MetricsProvider.getDynamicLogger();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li>Increase the counter by providing metric base name and optional tags associated with the metric.<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DynamicLogger dl = getDynamicLogger();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dl.incCounterValue(globalMetricName(SEGMENT_WRITE_BYTES), dataLength);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dl.incCounterValue(SEGMENT_WRITE_BYTES, dataLength, segmentTags(streamSegmentName));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div>Here <code>SEGMENT_WRITE_BYTES</code> is the base name of the metric. Below are the two metrics associated with it:</li></ol><ul><li>The global Counter which has no tags associated.</li><li>A Segment specific Counter which has a list of Segment tags associated.</li></ul><p>Note that, the <code>segmentTags</code> is a method to generate tags based on fully qualified Segment name.</p><p>The following are the required steps to register and use <code>OpStatsLogger(Timer)</code>:</p><ol><li><p>Get a <code>StatsLogger</code> from <code>MetricsProvider</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  StatsLogger STATS_LOGGER = MetricsProvider.getStatsLogger(&quot;segmentstore&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Register all the desired metrics through <code>StatsLogger</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Getter(AccessLevel.PROTECTED)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final OpStatsLogger createStreamSegment = STATS_LOGGER.createStats(SEGMENT_CREATE_LATENCY);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Use these metrics within code at the appropriate places where the values should be collected and recorded.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getCreateStreamSegment().reportSuccessEvent(elapsed);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Here <code>SEGMENT_CREATE_LATENCY</code> is the name of this metric, and <code>createStreamSegment</code> is the metric object, which tracks operations of <code>createSegment</code> and we will get the time (i.e. time taken by each operation and other numbers computed based on them) for each <code>createSegment</code> operation happened.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-for-dynamic-gauge"></a>Example for Dynamic Gauge<a class="hash-link" href="#example-for-dynamic-gauge" title="Direct link to heading">#</a></h2><p>This is an example from <code>io.pravega.controller.metrics.StreamMetrics</code>. In this class, we report
a Dynamic Gauge which represents the open Transactions of a Stream. The code for this example can be found <a href="https://github.com/pravega/pravega/blob/master/controller/src/main/java/io/pravega/controller/metrics/StreamMetrics.java" target="_blank" rel="noopener noreferrer">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-for-dynamic-meter"></a>Example for Dynamic Meter<a class="hash-link" href="#example-for-dynamic-meter" title="Direct link to heading">#</a></h2><p>This is an example from <code>io.pravega.segmentstore.server.SegmentStoreMetrics</code>. The code for this example can be found <a href="https://github.com/pravega/pravega/blob/master/segmentstore/server/src/main/java/io/pravega/segmentstore/server/SegmentStoreMetrics.java" target="_blank" rel="noopener noreferrer">here</a>. In the class <code>SegmentStoreMetrics</code>, we report a Dynamic Meter which represents the Segments created with a particular container.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metric-registries-and-configurations"></a>Metric Registries and Configurations<a class="hash-link" href="#metric-registries-and-configurations" title="Direct link to heading">#</a></h1><p>With Micrometer, each meter registry is responsible for both storage and exporting of metrics objects.
In order to have a unified interface, Micrometer provides the <code>CompositeMeterRegistry</code> for the application to interact with, <code>CompositeMeterRegistry</code> will forward metric operations to all the concrete registries bounded to it.</p><p>Note that when metrics service <code>start()</code>, initially only a global registry (of type <code>CompositeMeterRegistry</code>) is provided, which will bind concrete registries (e.g. statsD, Influxdb) based on the configurations. If no registry is switched on in <code>config</code>, metrics service throws error to prevent the global registry runs into no-op mode.</p><p>Mainly for testing purpose, metrics service can also <code>startWithoutExporting()</code>, where a <code>SimpleMeterRegistry</code> is bound to the global registry. <code>SimpleMeterRegistry</code> holds memory only storage but does not export metrics, makes it ideal for tests to verify metrics objects.</p><p>Currently Pravega supports the following:</p><ul><li>StatsD registry in <code>Telegraf</code> flavor.</li><li>Dimensional metrics data model (or metric tags).</li><li>UDP as Communication protocol.</li><li>Direct InfluxDB connection.</li></ul><p>The reporter could be configured using the <code>MetricsConfig</code>. Please refer to the <a href="https://github.com/pravega/pravega/blob/master/shared/metrics/src/main/java/io/pravega/shared/metrics/MetricsConfig.java" target="_blank" rel="noopener noreferrer">example</a>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-own-metrics"></a>Creating Own Metrics<a class="hash-link" href="#creating-own-metrics" title="Direct link to heading">#</a></h1><ol><li><p>When starting a Segment Store/Controller Service, start a Metric Service as a sub service. Please check <a href="#example-for-starting-a-metric-service"><code>ServiceStarter.start()</code></a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> public class AddMetrics {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        MetricsProvider.initialize(Config.METRICS_CONFIG);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        statsProvider.start(metricsConfig);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        statsProvider = MetricsProvider.getMetricsProvider();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        statsProvider.start();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Create a new <code>StatsLogger</code> instance through the <code>MetricsProvider.createStatsLogger(String loggerName)</code>, and register metric using name, e.g. <code>STATS_LOGGER.createCounter(String name)</code>; and then update the metric object as appropriately in the code.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> static final StatsLogger STATS_LOGGER = MetricsProvider.getStatsLogger(); // &lt;--- 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DynamicLogger dynamicLogger = MetricsProvider.getDynamicLogger();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static class Metrics { // &lt; --- 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     //Using Stats Logger</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final String CREATE_STREAM = &quot;stream_created&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final OpStatsLogger CREATE_STREAM = STATS_LOGGER.createStats(CREATE_STREAM);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final String SEGMENT_CREATE_LATENCY = &quot;segmentstore.segment.create_latency_ms&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final OpStatsLogger createStreamSegment = STATS_LOGGER.createStats(SEGMENT_CREATE_LATENCY);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     //Using Dynamic Logger</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final String SEGMENT_READ_BYTES = &quot;segmentstore.segment.read_bytes&quot;;  //Dynamic Counter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     static final String OPEN_TRANSACTIONS = &quot;controller.transactions.opened&quot;;    //Dynamic Gauge</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> //to report success or increment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Metrics.CREATE_STREAM.reportSuccessValue(1); // &lt; --- 3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Metrics.createStreamSegment.reportSuccessEvent(timer.getElapsed());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dynamicLogger.incCounterValue(Metrics.SEGMENT_READ_BYTES, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dynamicLogger.reportGaugeValue(OPEN_TRANSACTIONS, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> //in case of failure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Metrics.CREATE_STREAM.reportFailValue(1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Metrics.createStreamSegment.reportFailEvent(timer.getElapsed());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> //to freeze</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dynamicLogger.freezeCounter(Metrics.SEGMENT_READ_BYTES);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> dynamicLogger.freezeGaugeValue(OPEN_TRANSACTIONS);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ol><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-naming-conventions"></a>Metrics Naming Conventions<a class="hash-link" href="#metrics-naming-conventions" title="Direct link to heading">#</a></h1><p>All metric names are in the following format:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Metrics Prefix + Component Origin + Sub-Component (or Abstraction) + Metric Base Name</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol><li><p><strong>Metric Prefix</strong>: By default <code>pravega</code> is configurable.</p></li><li><p><strong>Component Origin</strong>: Indicates which component generates the metric, such as <code>segmentstore</code>, <code>controller</code>.</p></li><li><p><strong>Sub-Component (or Abstraction)</strong>: Indicates the second level component or abstraction, such as <code>cache</code>, <code>transaction</code>, <code>storage</code>.</p></li><li><p><strong>Metric Base Name</strong>: Indicates the <code>read_latency_ms</code>, <code>create_count</code>.</p></li></ol><p>For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pravega.segmentstore.segment.create_latency_ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Following are some common combinations of component and sub-components (or abstractions) being used:</p><ul><li><code>segmentstore.segment</code>: Metrics for individual Segments</li><li><code>segmentstore.storage</code>: Metrics related to long-term storage (Tier 2)</li><li><code>segmentstore.bookkeeper</code>: Metrics related to Bookkeeper (Tier 1)</li><li><code>segmentstore.container</code>: Metrics for Segment Containers</li><li><code>segmentstore.thread_pool</code>: Metrics for Segment Store thread pool</li><li><code>segmentstore.cache</code>: Cache-related metrics</li><li><code>controller.stream</code>: Metrics for operations on Streams (e.g., number of streams created)</li><li><code>controller.segments</code>: Metrics about Segments, per Stream (e.g., count, splits, merges)</li><li><code>controller.transactions</code>: Metrics related to Transactions (e.g., created, committed, aborted)</li><li><code>controller.retention</code>: Metrics related to data retention, per Stream (e.g., frequency, size of truncated data)</li><li><code>controller.hosts</code>: Metrics related to Pravega servers in the cluster (e.g., number of servers, failures)</li><li><code>controller.container</code>: Metrics related to Container lifecycle (e.g., failovers)</li></ul><p>Following are the two types of metrics:</p><ol><li><p><strong>Global Metric</strong>: <code>_global</code> metrics are reporting global values per component (Segment Store or Controller) instance, and further aggregation logic is needed if looking for Pravega cluster globals.
For instance, <code>STORAGE_READ_BYTES</code> can be classified as a Global metric.</p></li><li><p><strong>Object-based Metric</strong>: Sometimes, we need to report metrics only based on specific objects, such as Streams or Segments. This kind of metrics use metric name as a base name in the file and are &quot;dynamically&quot; created based on the objects to be measured.
For instance, in <code>CONTAINER_APPEND_COUNT</code> we actually report multiple metrics, one per each
<code>containerId</code> measured, with different container tag (e.g. <code>[&quot;containerId&quot;, &quot;3&quot;]</code>).</p></li></ol><p>There are cases in which we may want both a <em>Global</em> and <em>Object-based</em> versions for the same metric. For example, regarding <code>SEGMENT_READ_BYTES</code> we publish the Global version of it by adding <code>_global</code> suffix to the base name</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.segment.read_bytes_global</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>to track the globally total number of bytes read, as well as the per-segment version of it by using the same base name and also supplying additional Segment tags to report in a finer granularity the events read per Segment.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">segmentstore.segment.read_bytes, [&quot;scope&quot;, &quot;...&quot;, &quot;stream&quot;, &quot;...&quot;, &quot;segment&quot;, &quot;...&quot;, &quot;epoch&quot;, &quot;...&quot;])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="available-metrics-and-their-names"></a>Available Metrics and Their Names<a class="hash-link" href="#available-metrics-and-their-names" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-in-jvm"></a>Metrics in JVM<a class="hash-link" href="#metrics-in-jvm" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_gc_live_data_size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_gc_max_data_size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_gc_memory_allocated</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_gc_memory_prompted</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_gc_pause</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_memory_committed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_memory_max</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_memory_used</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_threads_daemon</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_threads_live</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_threads_peak</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> jvm_threads_states    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-in-segment-store-service"></a>Metrics in Segment Store Service<a class="hash-link" href="#metrics-in-segment-store-service" title="Direct link to heading">#</a></h2><ul><li><p>Segment Store Read/Write latency of storage operations (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histograms</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   segmentstore.segment.create_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   segmentstore.segment.read_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   segmentstore.segment.write_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store global and per-segment Read/Write Metrics (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counters</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   // Global counters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      segmentstore.segment.read_bytes_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      segmentstore.segment.write_bytes_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      segmentstore.segment.write_events_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   // Per segment counters - all with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream, &quot;segment&quot;, $segment, &quot;epoch&quot;, $epoch}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     segmentstore.segment.write_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     segmentstore.segment.read_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     segmentstore.segment.write_events</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store cache Read/Write latency Metrics (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.insert_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.get_latency</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store cache Read/Write Metrics (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counters</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.write_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.read_bytes</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store cache size (<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>) and generation spread (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a>) Metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.size_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.cache.gen</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Tier 1 Storage <code>DurableDataLog</code> Read/Write latency and queuing Metrics (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.total_write_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.write_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.write_queue_size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.write_queue_fill</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Tier 1 Storage <code>DurableDataLog</code> Read/Write (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>) and per-container ledger count Metrics (<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.write_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.bookkeeper.bookkeeper_ledger_count - with tag {&quot;container&quot;, $containerId}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Tier 2 Storage Read/Write latency Metrics (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.storage.read_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.storage.write_latency_ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Tier 2 Storage Read/Write data and file creation Metrics (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counters</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.storage.read_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.storage.write_bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.storage.create_count</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store container-specific operation Metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Histograms - all with tags {&quot;container&quot;, $containerId}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.process_operations.latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.process_operations.batch_size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_queue.size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_processor.in_flight</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_queue.wait_time</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_processor.delay_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_commit.latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation.latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_commit.metadata_txn_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation_commit.memory_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Gauge</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.operation.log_size</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store operation processor (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>) Metrics  - all with tags {&quot;container&quot;, $containerId}.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Counters/Meters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.append_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.append_offset_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.update_attributes_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.get_attributes_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.read_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.get_info_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.create_segment_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.delete_segment_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.merge_segment_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.seal_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.container.truncate_count</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Segment Store active Segments (<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>) and thread pool status (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histogram</a>) Metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Gauge - with tags {&quot;container&quot;, $containerId}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.active_segments</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Histograms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.thread_pool.queue_size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  segmentstore.thread_pool.active_threads</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metrics-in-controller-service"></a>Metrics in Controller Service<a class="hash-link" href="#metrics-in-controller-service" title="Direct link to heading">#</a></h2><ul><li><p>Controller Stream operation latency Metrics (<a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">Histograms</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.created_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.sealed_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.deleted_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.updated_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.truncated_latency_ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Controller global and per-Stream operation Metrics (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counters</a>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.create_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.create_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.sealed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.seal_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.stream.seal_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.deleted</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.delete_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.delete_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.updated_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.updated - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.update_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.update_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.truncated_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.truncated - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.truncate_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.stream.truncate_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Controller Stream retention frequency ([Counter](https://micrometer.io/docs/concepts#_counters)) and truncated size ([Gauge](https://micrometer.io/docs/concepts#_gauges)) Metrics:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.retention.frequency - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.retention.truncated_size - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Controller Stream Segment operations ([Counters](https://micrometer.io/docs/concepts#_counters)) and open/timed out Transactions on a Stream ([Gauge](https://micrometer.io/docs/concepts#_gauges)) Metrics  - all with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.transactions.opened</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.transactions.timedout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.segments.count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.segment.splits</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.segment.merges</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Controller Transaction operation latency Metrics:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.transactions.created_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.transactions.committed_latency_ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.transactions.aborted_latency_ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Controller Transaction operation counter Metrics:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.created_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.created - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.create_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.create_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.committed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.committed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.commit_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.commit_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.commit_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream,  &quot;transaction&quot;, $txnId}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.aborted_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.aborted - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.abort_failed_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.abort_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.transactions.abort_failed - with tags {&quot;scope&quot;, $scope, &quot;stream&quot;, $stream,  &quot;transaction&quot;, $txnId}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><p>Controller hosts available (<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>) and host failure (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>) Metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.hosts.count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.hosts.failures_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.hosts.failures - with tags {&quot;host&quot;, $host}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Controller Container count per host (<a href="https://micrometer.io/docs/concepts#_gauges" target="_blank" rel="noopener noreferrer">Gauge</a>) and failover (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>) Metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.hosts.container_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.container.failovers_global</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  controller.container.failovers - with tags {&quot;container&quot;, $containerId}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Controller Zookeeper session expiration (<a href="https://micrometer.io/docs/concepts#_counters" target="_blank" rel="noopener noreferrer">Counter</a>) metrics:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">controller.zookeeper.session_expiration</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="resources"></a>Resources<a class="hash-link" href="#resources" title="Direct link to heading">#</a></h1><ul><li><a href="https://micrometer.io/docs" target="_blank" rel="noopener noreferrer">Micrometer Metrics</a></li><li><a href="https://github.com/b/statsd_spec" target="_blank" rel="noopener noreferrer">Statsd_spec</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/claudiofahey/pravega/edit/docusaurus/documentation/src/docs/metrics.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/docs/pravega/deployment/aws-install"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Running on AWS</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/docs/pravega/auth/auth-plugin"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Implementation of Pravega Authentication/Authorization Plugin Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#metrics-service-provider--interface-statsprovider" class="table-of-contents__link">Metrics Service Provider â€” Interface StatsProvider</a></li><li><a href="#metric-logger--interface-statslogger" class="table-of-contents__link">Metric Logger â€” Interface StatsLogger</a></li><li><a href="#metric-sub-logger--opstatslogger" class="table-of-contents__link">Metric Sub Logger â€” OpStatsLogger</a></li><li><a href="#metric-logger--interface-dynamiclogger" class="table-of-contents__link">Metric Logger â€” Interface DynamicLogger</a></li><li><a href="#example-for-dynamic-counter-and-opstatsloggertimer" class="table-of-contents__link">Example for Dynamic Counter and OpStatsLogger(Timer)</a></li><li><a href="#example-for-dynamic-gauge" class="table-of-contents__link">Example for Dynamic Gauge</a></li><li><a href="#example-for-dynamic-meter" class="table-of-contents__link">Example for Dynamic Meter</a></li><li><a href="#metrics-in-jvm" class="table-of-contents__link">Metrics in JVM</a></li><li><a href="#metrics-in-segment-store-service" class="table-of-contents__link">Metrics in Segment Store Service</a></li><li><a href="#metrics-in-controller-service" class="table-of-contents__link">Metrics in Controller Service</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/sdp/overview">SDP Docs</a></li><li class="footer__item"><a href="https://www.dell.com/support/kbdoc/en-us/000124079/dell-emc-streaming-data-platform-infohub" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDP InfoHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/pravega" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/pravega" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/pravega" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/blog">SDP Blog</a></li><li class="footer__item"><a href="https://blog.pravega.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pravega Blog</a></li><li class="footer__item"><a href="https://github.com/pravega/pravega" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pravega GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Dell</div></div></div></footer></div>
<script src="/docs/assets/js/styles.dfd6e6ea.js"></script>
<script src="/docs/assets/js/runtime~main.5a82f47e.js"></script>
<script src="/docs/assets/js/main.f228fd44.js"></script>
<script src="/docs/assets/js/1.a92098fc.js"></script>
<script src="/docs/assets/js/2.e13a85bb.js"></script>
<script src="/docs/assets/js/88.bb5da98b.js"></script>
<script src="/docs/assets/js/89.14a0472b.js"></script>
<script src="/docs/assets/js/935f2afb.9331ca0d.js"></script>
<script src="/docs/assets/js/17896441.99919929.js"></script>
<script src="/docs/assets/js/8c217bf2.1bb5569c.js"></script>
</body>
</html>